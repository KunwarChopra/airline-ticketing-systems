----- TRIGGER TO UPDATE 'TICKET_PRICE_HISTORY' TABLE WHEN THE PRICE OF AN AIR TICKET IS UPDATED IN FLIGHT_COST TABLE ---- 
-- CREATING TABLE TICKET_PRICE_HISTORY -- 
CREATE TABLE TICKET_PRICE_HISTORY ( FLIGHT_NUMBER VARCHAR2(10) NOT NULL, ORIGIN_AIRPORT_CODE VARCHAR2(10) NOT NULL, DESTINATION_AIRPORT_CODE VARCHAR2(10) NOT NULL, COST_PRICE NUMBER NOT NULL, 
SELLING_PRICE NUMBER NULL, TOTAL_SEATS NUMBER NULL, AVAILABLE_SEATS NUMBER NOT NULL, 
 
CONSTRAINT FK_TICKET_PRICE_HISTORY FOREIGN KEY (FLIGHT_NUMBER) REFERENCES FLIGHT_SEGMENT(FLIGHT_NUMBER) 
); 
-- CREATE A TRIGGER TICKET_PRICE_HISTORY -- 
CREATE OR REPLACE TRIGGER TICKET_PRICE_HISTORY BEFORE UPDATE OF SELLING_PRICE ON FLIGHT_COST FOR EACH ROW 
BEGIN INSERT INTO TICKET_PRICE_HISTORY 
VALUES(:OLD.FLIGHT_NUMBER, :OLD.ORIGIN_AIRPORT_CODE, :OLD.DESTINATION_AIRPORT_CODE, :OLD.COST_PRICE, :OLD.SELLING_PRICE, :OLD.TOTAL_SEATS, :OLD.AVAILABLE_SEATS); 
END; 
SELECT * FROM TICKET_PRICE_HISTORY; 
--LET'S UPDATE A PRICE OR FARE OF AN AIR TICKET -- 
UPDATE FLIGHT_COST SET SELLING_PRICE=80 WHERE FLIGHT_NUMBER ='WA23231' AND ORIGIN_AIRPORT_CODE='SLC4' AND DESTINATION_AIRPORT_CODE='LAX6' AND AVAILABLE_SEATS=69 
SELECT * FROM FLIGHT_COST WHERE FLIGHT_NUMBER ='WA23231' AND ORIGIN_AIRPORT_CODE='SLC4' AND DESTINATION_AIRPORT_CODE='LAX6' AND AVAILABLE_SEATS=69; 
